<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge chrome=1">
    <meta name="renderer" content="webkit">
    <link rel="icon" href="./xds/favicon.ico" type="image/x-icon">
    <link href="./xds/resources/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="./xds/resources/js/vendor/bootstrap-3.2.0/css/bootstrap.min.css" />
    <link rel="stylesheet" href="./xds/resources/css/index.css" />
    <link rel="stylesheet" href="./xds/resources/js/vendor/alertify/css/alertify.core.css">
    <link rel="stylesheet" href="./xds/resources/js/vendor/alertify/css/alertify.bootstrap.css">
    <link href="./xds/resources/js/vendor/bootstrap-datetimepicker-0.0.11/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./xds/resources/css/loaders.css">
    <script type="text/javascript" src="./xds/bower_components/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="./xds/resources/js/vendor/district-picker/district.picker.css">
    <title>南开大学选调生系统</title>
    <style type="text/css" media="screen">
    .alertify-buttons {
        padding: 14px 15px 15px;
        background: #F5F5F5;
        border-top: 1px solid #DDD;
        border-radius: 0 0 6px 6px;
        box-shadow: inset 0 1px 0 #FFF;
    }

    .alertify-message {
        padding: 15px;
        margin: 0;
    }

    .login-btn-item {
        width: 100px;
    }

    a:hover {
        text-decoration: none;
    }
    </style>
    <style type="text/css">
    .slh {
        height: 38px;
        overflow: hidden;
        color:#595959;
        margin-bottom:8px;
    }
    .slh>div{
        float: right;
        margin-left: -5px;
        width: 100%;
        word-break: break-all;
    }
    .slh::before {
        float: left;
        width: 5px;
        content: '';
        height: 40px;
    }
    
    .slh::after {
        float: right;
        content: "...";
        height: 20px;
        line-height: 20px;
        /* 为三个省略号的宽度 */
        width: 3em;
        /* 使盒子不占位置 */
        margin-left: -3em;
        /* 移动省略号位置 */
        position: relative;
        left: 102%;
        top: -20px;
        padding-right: 47px;
        background-color: #FFF;
    }
    .zl-time{
        margin-right:32px;
    }
    .times img{
        width:14px;
        height: 10px;
        margin-right:4px;
    }
    .views{
        color:#666;
        text-align:right;
        line-height: 30px;
        font-size: 13px;
    }
    .views i{
        color:#812358;
        font-style: normal;
    }
    .baoItem{
        position: absolute;
        right: 0;
        top: 0;
        display: block;
        border-radius: 0px 8px 0 8px;
        padding:0 10px;
        height:24px;
        line-height: 24px;
        text-align: center;
        border: 1px solid #812358;
        color:#812358;
        font-size: 12px;
    }
    .article-item .item-intro .item-title{
        width: 93%;
    }
    
    .hotcont{
        height:30px;
        border-bottom:1px solid #812358;
        margin-bottom:10px;
    }
    .hotcont img{
        vertical-align: bottom;
        cursor: pointer;
    }
    .hotcont span{
        color:#812358;
        font-size:16px;
        margin-left:10px;
    }
    .organization{
        margin-right:30px;
    }
    .imgbox li{
        height: 50px;
    }
    
    [v-cloak] {
        display: none;
    }
    </style>
</head>

<body class="body">
    <section class="header"></section>
    
    <div class="main-content" id="gridBody" v-cloak>
        <div class="banner-content badg" style="padding-top:0;padding-bottom:0;">
            <form id="search-form" class="form-horizontal clearfix">
            </form>
            <!--  <ul id="gridBody"></ul> -->
            <div style="overflow: hidden">
                <ul style="width:915px;float: left;">
                     <li class="article-item clearfix" v-for="item in newlist1">
                        <template v-if="item.content_url == ''">
                            <a :href="'newsDetail.html?active=2&type=1&id='+item.id" class="item-title">
                                <div class="item-pic  pull-left">
                                    <div class="date-time text-c">
                                        <span>{{item.addtime | day}}</span>
                                        <div class="fen"></div>
                                        {{item.addtime | month}}
                                    </div>
                                </div>
                                <div class="item-intro">
                                    <div class="item-title">
                                        <template v-if="item.is_top != '2'">
                                            <i>顶</i>
                                        </template>
                                        {{item.title}}
                                    </div>
                                    <div class="slh">
                                        <div v-html="item.content"></div>
                                    </div>
                                    <div class="times">
                                        <img src="xds/resources/images/see.png" alt="">
                                        {{item.views}}
                                    </div>
                                </div>
                            </a>
                        </template>
                        <template v-else>
                            <a :href="item.content_url" class="item-title">
                                <div class="item-pic  pull-left">
                                    <div class="date-time text-c">
                                        <span>{{item.addtime | day}}</span>
                                        <div class="fen"></div>
                                        {{item.addtime | month}}
                                    </div>
                                </div>
                                <div class="item-intro">
                                    <div class="item-title">
                                        <template v-if="item.is_top != '2'">
                                            <i>顶</i>
                                        </template>
                                        {{item.title}}
                                    </div>
                                    <div class="slh">
                                        <div v-html="item.content"></div>
                                    </div>
                                    <div class="times">
                                        <img src="xds/resources/images/see.png" alt="">
                                        {{item.views}}
                                    </div>
                                </div>
                            </a>
                        </template>
                    </li>
                </ul>
                <ul class="imgbox" v-if="newimg">
                    <div class="hotcont">
                        <img src="xds/resources/images/hots.png" alt="">
                        <span>相关链接</span>
                    </div>
                    <li v-for="index in newimg">
                        <template>
                            <a :href="'newsDetail.html?active=2&type=1&id='+index.id" class="index-title">
                                <div class="item-pic  pull-left">
                                    <div class="date-time text-c">
                                        <span>{{index.addtime | day}}</span>
                                        <div class="fen"></div>
                                        {{index.addtime | month}}
                                    </div>
                                </div>
                                <div class="item-right">
                                    <div class="item-title">
                                        {{index.title}}
                                    </div>
                                </div>
                            </a>
                        </template>
                        <template v-else>
                            <a :href="index.content_url" class="index-title">
                                <div class="item-pic  pull-left">
                                    <div class="date-time text-c">
                                        <span>{{index.addtime | day}}</span>
                                        <div class="fen"></div>
                                        {{index.addtime | month}}
                                    </div>
                                </div>
                                <div class="item-right">
                                    <div class="item-title">
                                        {{index.title}}
                                    </div>
                                </div>
                            </a>
                        </template>
                    </li>
                </ul>
            </div>
            <div align="center" class="clearfix">
                <div class="pages_wrapper" id="footpage"></div>
            </div>
        </div>
    </div>
    <!-- footer -->
    <section class="footer"></section>
    </div>
    <script src="./xds/resources/js/vendor/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="./xds/bower_components/nivo-slider/jquery.nivo.slider.js"></script>
    <script src="./xds/resources/js/vendor/bootstrap-paginator.js"></script>
    <script src="./xds/resources/js/vendor/template.js"></script>
    <script src="./xds/resources/js/vendor/template-util.js"></script>
    <script src="./xds/resources/js/vendor/bootstrap-datetimepicker-0.0.11/js/bootstrap-datetimepicker.js"></script>
    <script src="./xds/resources/js/vendor/bootstrap-datetimepicker-0.0.11/js/bootstrap-datetimepicker.zh-CN.js"></script>
    <script src="./xds/bower_components/bootstrapValidator/dist/js/bootstrapValidator.js"></script>
    <script src="./xds/resources/js/vendor/alertify/js/alertify.js"></script>
    <script src="./xds/resources/js/vendor/ajaxfileupload.js"></script>
    <script src="./xds/resources/js/vendor/district-picker/jquery.district.picker.js"></script>
    <script src="./xds/resources/js/vendor/common.js"></script>
    <script src="./xds/resources/js/vendor/page2.js "></script>
    <script src="./xds/resources/js/vendor/config.js"></script>
    <script src="./xds/resources/js/vendor/api.js"></script>
    <script src="./xds/resources/js/vendor/vue.min.js"></script>
    <script src="./xds/resources/js/vendor/wx_get_openid.js"></script>
</body>
<script>

$(".header").load("../public/header.html");
$(".footer").load("../public/footer.html");
var school_id = sessionStorage.getItem("school_id");
var stu_id = sessionStorage.getItem('userid')||'';
var news6 = sessionStorage.getItem('news6');//通知公告
var keywords = $.getUrlParam("keywords") || "";
var size = 15;
var cpage = $.getUrlParam("page");
cpage = parseInt(cpage);
if(!cpage || cpage < 1){
    cpage = 1;
}
// console.log(page);

var vm = new Vue({
    el: "#gridBody",
    data: {
        newlist1: [], //招录公告
        total:0,
        pagesize:size,
        newimg:[],
        is_old_student:'', //学生类型
    },
    updated:function(){
        var onPagechange = function (page) {
            // console.log('当前点击页码', page);
            // window.location.href = $.UrlUpdateParams(window.location.href, 'page', page);
            window.location.href = "newsList.html?active=2&page="+page+"&keywords="+keywords;
        }
        var obj = {
            wrapid: 'footpage', //页面显示分页器容器id
            total: vm.total, //总条数
            pagesize: vm.pagesize, //每页显示10条
            currentPage: cpage, //当前页
            onPagechange: onPagechange,
            //btnCount:7 页数过多时，显示省略号的边界页码按钮数量，可省略，且值是大于5的奇数
        }
        if (vm.allpage > 0) {
            console.log(obj);
            pagination.init(obj);
        }
        
        $(".imgbox li").hover(function(){
            $(this).find(".date-time").show();
        },function(){
            $(this).find(".date-time").hide();
        })

        $('#gridBody').css('min-height',$(window).height()-360);
    },
    filters: {
        year:function(value) {
            if (value == 0) {
                return "";
            }
            var date = new Date(value * 1000);
            Y = date.getFullYear();
            return Y;
        },
        month:function(value) {
            if (value == 0) {
                return "";
            }
            var date = new Date(value * 1000);
            M = date.getMonth();
            var month = ['1','2','3','4','5','6','7','8','9','10','11','12'];
            return month[M]+"月";
        },
        day:function(value) {
            if (value == 0) {
                return "";
            }
            var date = new Date(value * 1000);
            D = date.getDate();
            return D;
        },
        time:function(value){
            if (value == 0) {
                return "";
            }
            var date = new Date(value * 1000);
            Y = date.getFullYear() + '-';
            M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
            D = date.getDate() + ' ';
            h = date.getHours() + ':';
            m = date.getMinutes() + ':';
            s = date.getSeconds();
            return Y + M + D;
        },
    },
})

//通知公告
http('POST', '/Article/getlist', { "school_id": school_id,"cate_id": news6,"page": cpage, "size": size,"keywords":keywords,"show_type":1}, function(e) {
    vm.newlist1 = e.data.list;
    vm.total = e.data.count;
    vm.allpage = e.data.allpage;
});
//基本信息详情
http('post','/User/detail',{"id":stu_id}, user_infor);
function user_infor(e){
    vm.is_old_student = e.data.is_old_student;
   
}
//图片浏览量排序
// http('POST', '/Selectstu/getclicklist', { "school_id": school_id,'user_id':stu_id}, function(e) {
//     console.log(e,66);
//     vm.newimg = e.data.list;
// });
// http('POST', '/Selectstu/getClickList', { "school_id": school_id,"show_type":1}, function(e) {
//     vm.newimg = e.data.list;
// });
http('POST', '/Article/getsortviewlist', { "school_id": school_id,"cate_id": news6,"show_type":1}, function(e) {
    console.log(e,88);
    vm.newimg = e.data.list;
});

</script>

<!-- <script type="text/html" id="gridTpl">
    {{if content.length>0}} {{each content as v }}
    <li class="article-item clearfix">
        {{if v.type=='选调政策' || v.type =='选调心声'}}
        <a href="./xds/news/detail/{{v.id}}" style="color:#333;">
                    <i class="fa fa-dot-circle-o" style="color:#812358"></i> {{if v.top==1}}<b style="color:#812358;">【置顶】</b>{{/if}} {{v.title}}
                    <label style="float:right">{{v.createTime}}</label>
                </a> {{else}}
        <div class="item-pic  pull-left">
            <div class="date-time text-c">{{#v.createTimeStr}}</div>
        </div>
        <div class="item-intro">
            <a href="./xds/news/detail/{{v.id}}" class="item-title">
                        {{if v.top==1}}<b style="color:#812358;">【置顶】</b>{{/if}} {{v.title}}
                        </a>
            <div class="item-desc add-ellipsis2 slh">{{#v.content}}</div>
        </div>
        {{/if}}
    </li>
    {{/each}} {{else}}
    <li class="no-data">暂无查询结果</li>
    {{/if}}
</script>
<script type="text/html" id="ly-gridTpl">
    {{if content.length>0}} {{each content as v }}
    <li class="article-item clearfix">
        <div class="item-pic  pull-left">
            <div class="date-time text-c">{{#v.createTimeStr}}</div>
        </div>
        <div class="item-intro">
            <a href="./xds/news/detail/{{v.id}}" class="item-title">
                {{v.createUserName}}:{{v.content}}
            </a>
            <div class="item-desc add-ellipsis2 slh">{{#v.content}}</div>
        </div>
    </li>
    {{/each}} {{else}}
    <li class="no-data">暂无查询结果</li>
    {{/if}}
</script>
<script type="text/html" id="by-gridTpl">
    {{if content.length>0}} {{each content as v }}
    <li class="article-item clearfix">
        <div class="item-pic  pull-left">
            <img src="/xds{{v.img}}" style="width:175px" onerror="onerror=null;src='./xds/resources/images/default-picture.png'">
        </div>
    </li>
    {{/each}} {{else}}
    <li class="no-data">暂无查询结果</li>
    {{/if}}
</script> -->

</html>